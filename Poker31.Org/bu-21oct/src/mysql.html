<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Show and hide layers</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"></script>
<style>
body { margin: 0; padding: 0; }
#map { position: absolute; top: 0; bottom: 0; width: 100%; }
</style>
</head>
<body>



<?php
	include('/includes/config.php');  
     
    $result = mysqli_query($con,"SELECT * FROM 't-map' ");
    $row = mysqli_fetch_array($result);
	echo $row['nom'];
?>

<!--
	
<script>
      mapboxgl.accessToken = 'pk.eyJ1IjoiZnJhbmNrdzMxIiwiYSI6ImNsbmJqemU5cjA0MDYya3RkczNrMHdqb2wifQ.6NLEMz-lShL80j9QuGW9cA';
        var map = new mapboxgl.Map({
            container: 'map',
            // style: 'mapbox://styles/mapbox/streets-v11',
            // center:  [<?php echo $row['lat'];?>,<?php echo $row['lng'];?>],
            style: 'mapbox://styles/franckw31/clnd1m23b03o501qu3x5ab4xk',
            center: [1.42056, 43.60842],
			zoom: 8
        });
        // Add geolocate control to the map.
            map.addControl(
        new mapboxgl.GeolocateControl({
            positionOptions: {
                enableHighAccuracy: true
            },
            trackUserLocation: true
            },
            ),'bottom-right'
        )
    ;
       
        //add markers

            map.on('load', function() {
			map.addSource('poker', {
            'type': 'geojson',
            'data': {
                'type': 'FeatureCollection',
                'features': [
                <?php  while ($row = $result->fetch_assoc()): ?>
                    {
                        'type': 'Feature',
                        'properties': {
                            'description':
                               '<p>Waypoint main</p><img src="/assets/images/latitude.svg" alt="Latitude" width="25" height="25">&nbsp;&nbsp;<strong>Latitude:</strong>&nbsp;<?php echo $row['lat'];?><br><br><img src="/assets/images/longitude.svg" alt="Longitude" width="25" height="25">&nbsp;&nbsp;<strong>Longitude:</strong>&nbsp;<?php echo $row['lng'];?><br><br><img src="/assets/images/location.svg" alt="Next Way Point" width="25" height="25">&nbsp;<strong>To Next Waypoint:</strong>&nbsp;<?php echo $row['from_waypoint'];?><br><br><img src="/assets/images/direction.svg" alt="Bearing" width="25" height="25">&nbsp;&nbsp;<strong>Bearing:</strong>&nbsp;<?php echo $row['bearing'];?><br><br><img src="/assets/images/total%20distance.svg" alt="Total Distance" width="25" height="25">&nbsp;&nbsp;<strong>From start:</strong>&nbsp;<?php echo $row['from_start'];?><br><br>',
                            'icon': 'poker',
                            'iconSize': '15'
                        },
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [<?php echo $row['lat'];?>, <?php echo $row['lng'];?>]
                        }
                    }<?php 
// only if there is another line
  if ($row = $result->fetch_assoc()) echo "," 
?>
<?php endwhile; ?>
                            {
                        'type': 'Feature',
                        'properties': {
                            'description':
                               '<p>Waypoint</p>Latitude:</strong><?php echo $row['lat'];?><br><strong>Longitude:</strong><?php echo $row['lng'];?><strong>To Next Waypoint:</strong><br><strong>Bearing:</strong><br><strong>From start:</strong><?php echo $row['froms_tart'];?><br><br>',
                            'icon': 'poker',
                            'iconSize': '15'
                        },
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [<?php echo $row['lat'];?>, <?php echo $row['lng'];?>]
                        }
                    }
                ]
            }
        });
        // Add a layer showing the places.
        map.addLayer({
            'id': 'poker',
            'type': 'symbol',
            'source': 'poker',
            'layout': {
                'icon-image': 'poker',
                'icon-size': 0.25,
                'icon-allow-overlap': true
            }
        });
    // When a click event occurs on a feature in the places layer, open a popup at the location of the feature, with description HTML from its properties.
    map.on('click', 'poker', function(e) {
        var coordinates = e.features[0].geometry.coordinates.slice();
        var description = e.features[0].properties.description;
        // Ensure that if the map is zoomed out such that multiple copies of the feature are visible, the popup appears over the copy being pointed to.
        while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
            coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
        }
        new mapboxgl.Popup()
            .setLngLat(coordinates)
            .setHTML(description)
            .addTo(map);
    });
    // Change the cursor to a pointer when the mouse is over the places layer.
    map.on('mouseenter', 'poker', function() {
        map.getCanvas().style.cursor = 'pointer';
    });
    // Change it back to a pointer when it leaves.
    map.on('mouseleave', 'poker', function() {
        map.getCanvas().style.cursor = '';
    });
});
        map.addControl(new mapboxgl.NavigationControl(), 'bottom-right');
      </script>
	  
-->	  
	 </body>
</html>